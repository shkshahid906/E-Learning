{% extends 'base.html' %}
{% block title %}Manage Teachers - StudyNode{% endblock %}

{% block content %}
<style>
    .teacher{
     margin: 6% 17%;
    }
    button{
        background: red;
        color: white;
        padding: 15%;
        border: none;
        border-radius: 20px;

    }
</style>
<div class="teacher">
<h2>ğŸ‘¨â€ğŸ« Teacher Management</h2>

<form method="GET" action="{{ url_for('admin_manage_teachers') }}">
  <input type="text" name="search" placeholder="Search by name or username..." value="{{ request.args.get('search', '') }}">
  <button type="submit">Search</button>
</form>

<table class="table">
  <thead>
    <tr>
      <th>ID</th><th>Name</th><th>Username</th><th>Email</th><th>Joined</th><th>Actions</th>
    </tr>
  </thead>
  <tbody>
    {% for t in teachers %}
    <tr>
      <td>{{ t.ID }}</td>
      <td>{{ t.Name }}</td>
      <td>{{ t.Username }}</td>
      <td>{{ t.Email }}</td>
      <td>{{ t.Registration_date.strftime('%Y-%m-%d') }}</td>
      <td>
        <button onclick="deleteUser({{ t.ID }})">Delete</button>
      </td>
    </tr>
    {% endfor %}
  </tbody>
</table>
</div>
<script>
  function deleteUser(userId) {
    if (!confirm('Are you sure you want to delete this user?')) return;

    fetch(`/admin/delete/${userId}`, {
      method: 'POST',
      headers: {
        'Content-Type': 'application/json'
      }
    })
    .then(response => {
      if (response.ok) {
        alert("User deleted successfully");
        location.reload(); // Or remove the row dynamically
      } else {
        return response.json().then(data => {
          alert("Failed to delete user: " + (data.message || "Unknown error"));
        });
      }
    })
    .catch(error => {
      console.error('Error:', error);
      alert('An error occurred while deleting user.');
    });
  }
</script>
{% endblock %}


